# --- Zerodha ---
ZERODHA_API_KEY=9a6h8ko5o1myv0hp
ZERODHA_API_SECRET=9yuor4cxqou1a9t3hkh4wsg1oz64hbsg
# Prefer this:
KITE_ACCESS_TOKEN=TJTSLetOguSJw2acdpm20YafpFI0h7bD
# (legacy) If you still have old setups:
ZERODHA_ACCESS_TOKEN=TJTSLetOguSJw2acdpm20YafpFI0h7bD

# --- Telegram ---
TELEGRAM_BOT_TOKEN=7962917167:AAGyIOqZJLq-TKz-ozZODcDT4syeVWFIybU
TELEGRAM_CHAT_ID=6931456598

# ===== MODES / TOGGLES =====
ENABLE_LIVE_TRADING=true
ENABLE_TELEGRAM=true
ALLOW_OFFHOURS_TESTING=false          # turn ON only when testing off-market
PREFERRED_EXIT_MODE=REGULAR
USE_SLM_EXIT=true
SL_LIMIT_OFFSET_TICKS=2

# ===== STRATEGY CORE (tighter but still active) =====
MIN_SIGNAL_SCORE=3                    # 2=more trades, 4=fewer; 3 is a good middle
CONFIDENCE_THRESHOLD=5.8
BASE_STOP_LOSS_POINTS=20.0
BASE_TARGET_POINTS=40.0
ATR_PERIOD=14
ATR_SL_MULTIPLIER=1.6                 # slightly tighter initial SL
ATR_TP_MULTIPLIER=3.2                 # slightly bigger RR
SL_CONFIDENCE_ADJ=0.15
TP_CONFIDENCE_ADJ=0.35

# ===== DATA / WARMUP =====
WARMUP_BARS=30
DATA_LOOKBACK_MINUTES=60
HISTORICAL_TIMEFRAME=minute
SKIP_FIRST_MIN=5                      # ignore first 5 mins after market open

# ===== INSTRUMENTS =====
SPOT_SYMBOL=NSE:NIFTY 50
TRADE_SYMBOL=NIFTY
TRADE_EXCHANGE=NFO
INSTRUMENT_TOKEN=256265
NIFTY_LOT_SIZE=75
MIN_LOTS=1
MAX_LOTS=12                           # allow more lots if risk permits
STRIKE_RANGE=2      # consider ±2 strikes around ATM (good liquidity)

# ===== RISK / CIRCUIT BREAKERS =====
RISK_PER_TRADE=0.03                   # ~3% of equity -> larger position = more profits when right
MAX_DRAWDOWN=0.07
CONSECUTIVE_LOSS_LIMIT=3
MAX_DAILY_DRAWDOWN_PCT=0.05           # used by RealTimeTrader circuit
CIRCUIT_RELEASE_PCT=0.015
DAILY_MAX_LOSS_PCT=0.06               # extra guard (if used elsewhere)
DAILY_MAX_LOSS_AMOUNT=0               # 0=disabled (set e.g. 3000 to cap absolute ₹)
HALT_ON_DRAWDOWN=true
MAX_CONCURRENT_POSITIONS=1            # keep single-position policy

# ===== OPTIONS BREAKOUT FILTERS (a bit stricter to improve quality) =====
OPTION_TYPE=BOTH
OPTION_SL_PERCENT=0.05
OPTION_TP_PERCENT=0.20
OPTION_BREAKOUT_PCT=0.004
OPTION_SPOT_TREND_PCT=0.003

# ===== EXECUTION / WORKERS =====
DEFAULT_PRODUCT=MIS
DEFAULT_ORDER_TYPE=MARKET
DEFAULT_VALIDITY=DAY
TICK_SIZE=0.05
TRAILING_ENABLE=true
TRAIL_COOLDOWN_SEC=10                 # trail a little faster
WORKER_INTERVAL_SEC=5

# ===== SPREAD / MICROSTRUCTURE GUARDRAILS =====
SPREAD_GUARD_MODE=RANGE               # stable & fast (no depth required)
SPREAD_GUARD_BA_MAX=0.012             # tighter = better fills
SPREAD_GUARD_LTPMID_MAX=0.012
SPREAD_GUARD_PCT=0.02

# ===== FEES / SLIPPAGE =====
SLIPPAGE_BPS=4.0
FEES_PER_LOT=25.0

# ===== PARTIAL TP / BREAKEVEN / HARD STOP =====
PARTIAL_TP_ENABLE=true
PARTIAL_TP_RATIO=0.4                  # 40% lots at TP1; let 60% run
PARTIAL_TP_USE_MIDPOINT=true          # TP1 midpoint, TP2 at strategy TP
BREAKEVEN_AFTER_TP1_ENABLE=true
BREAKEVEN_OFFSET_TICKS=2              # hop to breakeven + 2 ticks after TP1
HARD_STOP_ENABLE=true
HARD_STOP_GRACE_SEC=3.0
HARD_STOP_SLIPPAGE_BPS=6
PARTIAL_TP2_R_MULT=2.0

# ===== LOGGING =====
LOG_FILE=logs/trades.csv
DIAGNOSTIC_VERBOSE=false
LOG_LEVEL=INFO
BALANCE_LOG_INTERVAL_MIN=30

# ===== HOURS (IST) =====
USE_IST_CLOCK=true
TIME_FILTER_START=09:20               # avoid opening churn
TIME_FILTER_END=15:20                 # avoid late-day illiquidity

USE_GREEKS_STRIKE_RANKING=true
TARGET_DELTA_CALL=0.35
TARGET_DELTA_PUT=-0.35
DELTA_TOL=0.05
REQUIRE_OI=true
MIN_OI=50000
RISK_FREE_RATE=0.06
IV_SOURCE=LTP_IMPLIED
EXPIRY_PREFERENCE=NEAR
OPTION_REQUIRE_SPOT_CONFIRM=true

# --- Advanced scheduling / control ---
PEAK_POLL_SEC=15
OFFPEAK_POLL_SEC=30
MAX_TRADES_PER_DAY=20
LOSS_COOLDOWN_MIN=2
PREFERRED_TIE_RULE=TREND   # or CONFIDENCE_ONLY